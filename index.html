<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="styles.css" />
  <title>Jack's D&D Tools</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
</head>
<body>
  <h1>Welcome to the 7 Sons of Valkari!</h1>
  <p>The home for Dungeons & Dragons ideas and Jacks programming projects.</p>

  <a href="#tools" class="button">Explore Tools</a>
  <section id="tools" style="margin-top: 60px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;">
  <h2 style="color: #f39c12; text-shadow: 1px 1px 3px #000;">My D&D Tools</h2>
  <ul style="color: #ddd; font-size: 1.1em; line-height: 1.6;">
    <li><strong>Loot Table:</strong> Quickly random loot for you campaigns. </li>
    <section id="loot-generator" style="max-width: 600px; margin: 40px auto; text-align: left;">
  <h2>Random Loot Generator</h2>
  
  <label for="table-select">Select Loot Table:</label>
  <select id="table-select">
    <option value="">--Choose a table--</option>
    <option value="arcana">Arcana</option>
    <option value="armaments">Armaments</option>
    <option value="implements">Implements</option>
    <option value="relics">Relics</option>
  </select>

  <br /><br />

  <label for="rarity-select">Select Rarity:</label>
  <select id="rarity-select">
    <option value="">--Choose rarity--</option>
    <option value="Common">Common</option>
    <option value="Uncommon">Uncommon</option>
    <option value="Rare">Rare</option>
    <option value="Very Rare">Very Rare</option>
  </select>

  <br /><br />

  <label for="roll-input">Enter Roll (1-100):</label>
  <input type="number" id="roll-input" min="1" max="100" />

  <br /><br />

  <button id="get-loot-btn">Get Loot</button>

  <p id="loot-result" style="font-weight: bold; color: #f39c12; margin-top: 20px;"></p>
</section>

    <li><strong>NPC Generator:</strong> Create unique characters with traits and backgrounds.</li>
 
  </ul>
</section>


  <footer>
    &copy; 2025 Jack Poulter
  </footer>

  <script> // Random Loot Generator Script
  async function loadLootTable(tableName) {
    if (!tableName) return null;
    try {
      const response = await fetch(`${tableName}_loot.json`);
      if (!response.ok) throw new Error("Failed to load loot table.");
      const data = await response.json();
      return data;
    } catch (error) {
      alert(error.message);
      return null;
    }
  }

  function filterByRarity(data, rarity) {
    return data.filter(entry => entry.rarity.toLowerCase() === rarity.toLowerCase());
  }

  function lookupLoot(data, roll) {
    for (const entry of data) {
      const [start, end] = entry.range;
      if (roll >= start && roll <= end) {
        return entry;
      }
    }
    return null;
  }

  document.getElementById("get-loot-btn").addEventListener("click", async () => {
    const tableName = document.getElementById("table-select").value;
    const rarity = document.getElementById("rarity-select").value;
    const roll = parseInt(document.getElementById("roll-input").value, 10);

    const resultEl = document.getElementById("loot-result");
    resultEl.textContent = "";

    if (!tableName) {
      alert("Please select a loot table.");
      return;
    }
    if (!rarity) {
      alert("Please select a rarity.");
      return;
    }
    if (isNaN(roll) || roll < 1 || roll > 100) {
      alert("Please enter a roll between 1 and 100.");
      return;
    }

    const tableData = await loadLootTable(tableName);
    if (!tableData) return;

    const filtered = filterByRarity(tableData, rarity);
    if (filtered.length === 0) {
      resultEl.textContent = `No items found for rarity '${rarity}'.`;
      return;
    }

    const loot = lookupLoot(filtered, roll);
    if (loot) {
      resultEl.textContent = `You found: ${loot.item} (Rarity: ${loot.rarity})`;
    } else {
      resultEl.textContent = "No item found for this roll and rarity.";
    }
  });
</script> 

</body>
</html>
